= Ephemeral World Demo Scripts

This repository is for setup guides and scripts for my presentation on
Ephemeral environments using https://www.osbuild.org/[Image Builder] and https://buildah.io/[buildah].

This demo and talk leverage these operating systems

* https://fedoraproject.org[Fedora 35]
* https://redhat.com[Red Hat Enterprise Linux 8.x]
* https://redhat.com[Red Hat Enterprise Linux 9] *_Beta_*

In line with the talks focus on ephemeral environments we'll leverage cloud ready
images for the OS than can be rapidly configured via Ansible to demo the
key technologies.

== Deployment of Cloud / Virt ready OS Images

If you're running this demo code on a cloud hosted environment then simply select their pre-configured
cloud ready image, and skip to the setup of the demo tooling using Ansible below.

These instructions are for when you're running this locally under KVM + Libvirt.

Validated Images

* rhel-baseos-9.0-beta-0-x86_64-kvm.qcow2 
* rhel-8.5-x86_64-kvm.qcow2
* Fedora-Cloud-Base-35-1.2.x86_64.qcow2 




== Issues / Gotchas

=== Running out of space
The VM Images we're running are relatively small from a storage perspective so there is a chance
you'll run out of scratch space if you attempt to create very large images.


=== RHEL 9 Beta
At present the default install of RHEL 9 Beta attempts to use the production RHEL 9 content
repositories when building images. This issue is similar to the problem under.

* https://access.redhat.com/solutions/5773421

Currently the issue can be resolved by running the following on your RHEL9 VM

[source,bash]
----
mkdir -pv /etc/osbuild-composer/repositories

cp /usr/share/osbuild-composer/repositories/rhel-90.json /etc/osbuild-composer/repositories/rhel-90.json

cp -p /etc/osbuild-composer/repositories/rhel-90.json{,.bak}

sed -i -e 's|cdn.redhat.com/content/dist/rhel9|cdn.redhat.com/content/beta/rhel9|' \
/etc/osbuild-composer/repositories/rhel-90.json

systemctl restart osbuild-worker@.service.d osbuild-worker@1.service osbuild-composer.service
----


== Standards

All documentation will licenced under a http://creativecommons.org/licenses/by-sa/4.0/[Creative Commons Attribution-ShareAlike 4.0 International License],
whilst code, including Ansible playbooks, will be under a link:LICENSE[GPL v3 licence].

image::https://licensebuttons.net/l/by-sa/4.0/88x31.png[CC BY-SA-4.0 Logo]

All documentation will be treated like code and produced where possible in https://docs.asciidoctor.org/asciidoc/latest[AsciiDoc].
